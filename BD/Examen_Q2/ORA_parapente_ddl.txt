DROP TABLE REPARATION;
DROP TABLE VOL;
DROP TABLE VOILE;
DROP TABLE MODELEVOILE;
DROP TABLE DEPARTARRIVEE;
DROP TABLE SITEARRIVEE;
DROP TABLE SITEDEPART;
DROP TABLE MONITEUR;
DROP TABLE MEMBRE;
DROP TABLE NIVEAU;

CREATE TABLE NIVEAU(
 idNiveau 		INTEGER PRIMARY KEY,
 nom 			VARCHAR2(50) NOT NULL UNIQUE
);

CREATE TABLE MEMBRE(
 numLicence 	CHAR(14) PRIMARY KEY,
 nom        	VARCHAR2(100) NOT NULL,
 prenom			VARCHAR2(100) NOT NULL,
 email			VARCHAR2(100) NOT NULL UNIQUE,
 telephone		VARCHAR2(40) NOT NULL,
 dateNaissance 	DATE,
 poids			NUMERIC(4,1) NOT NULL,
 rue			VARCHAR2(100) NOT NULL,
 numero			VARCHAR2(10) NOT NULL,
 localite		VARCHAR2(100) NOT NULL,
 codePostal		NUMERIC(4) NOT NULL,
 idNiveau		INTEGER	NOT NULL REFERENCES NIVEAU(idNiveau)
);

CREATE TABLE MONITEUR(
 numLicence 	CHAR(14) PRIMARY KEY,
 nom        	VARCHAR2(100) NOT NULL,
 prenom			VARCHAR2(100) NOT NULL,
 email			VARCHAR2(100) NOT NULL UNIQUE,
 telephone		VARCHAR2(40) NOT NULL,
 dateNaissance 	DATE,
 poids			NUMERIC(4,1) NOT NULL,
 rue			VARCHAR2(100) NOT NULL,
 numero			VARCHAR2(10) NOT NULL,
 localite		VARCHAR2(100) NOT NULL,
 codePostal		NUMERIC(4) NOT NULL
);

CREATE TABLE SITEDEPART(
 idSiteDepart	INTEGER PRIMARY KEY,
 nom			VARCHAR2(100) NOT NULL UNIQUE,
 altitude		INTEGER NOT NULL,
 distanceBase	NUMERIC(4,1) NOT NULL
);

CREATE TABLE SITEARRIVEE(
 idSiteArrivee	INTEGER PRIMARY KEY,
 nom			VARCHAR2(100) NOT NULL UNIQUE,
 altitude		INTEGER NOT NULL,
 distanceBase	NUMERIC(4,1) NOT NULL
);

CREATE TABLE DEPARTARRIVEE(
 idSiteDepart	INTEGER REFERENCES SITEDEPART(idSiteDepart),
 idSiteArrivee	INTEGER REFERENCES SITEARRIVEE(idSiteArrivee),
 PRIMARY KEY (idSiteDepart,idSiteArrivee)
);

CREATE TABLE MODELEVOILE(
 idModeleVoile	INTEGER PRIMARY KEY,
 marque			VARCHAR2(100) NOT NULL,
 modele			VARCHAR2(100) NOT NULL,
 type			CHAR(1) NOT NULL,
 poidsMax		INTEGER NOT NULL
);

CREATE TABLE VOILE (
 idVoile		INTEGER PRIMARY KEY,
 dateAchat		DATE NOT NULL,
 couleur		VARCHAR2(100),
 etat			CHAR(1) NOT NULL,
 idModeleVoile	INTEGER NOT NULL REFERENCES MODELEVOILE(idModeleVoile),
 CONSTRAINT valeursEtat CHECK (etat IN ('N','T','B','R', 'H'))
 );

CREATE TABLE VOL (
 idVol				INTEGER PRIMARY KEY,
 dateVol			DATE NOT NULL,
 dureePrevue		INTEGER,
 statut				CHAR(1) NOT NULL,
 dateReservation	DATE NOT NULL,
 numLicenceMembre	CHAR(14) NOT NULL REFERENCES MEMBRE(numLicence),
 numLicenceMoniteur	CHAR(14) REFERENCES MONITEUR(numLicence),
 idVoile			INTEGER NOT NULL REFERENCES VOILE(idVoile),
 idSiteDepart		INTEGER NOT NULL REFERENCES SITEDEPART(idSiteDepart),
 idSiteArrivee		INTEGER NOT NULL REFERENCES SITEARRIVEE(idSiteArrivee),
 CONSTRAINT valeursStatut CHECK (statut IN ('P','A','E','T'))
);

CREATE TABLE REPARATION (
 idReparation	INTEGER PRIMARY KEY,
 description	VARCHAR2(1000) NOT NULL,
 dateDebut 		DATE NOT NULL,
 dureeEstimee	INTEGER NOT NULL,
 dateFin		DATE,
 idVoile		INTEGER NOT NULL REFERENCES VOILE(idVoile)
);





COMMIT;